🚀 IKH AUTOMATION STARTED
==================================================
📂 Category: IKH
📄 CSV File: personnel_list_ALL.csv
📅 Date: 2025-08-14
⏰ Shift: 1
🔧 Script: static/ikh_automation.py
💻 Command: python3 static/ikh_automation.py personnel_list_ALL.csv 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 --date=2025-08-14 --shift=1
==================================================

🖥️ Browser mode: Headless (Background)
[FILE] CSV Headers: ['Nama', 'Nomor']
✅ Added: DANI IBRAHIM - NIK: 3209252101970001
✅ Added: ASEP PRIYATMAN - NIK: 3214012511700001
✅ Added: SLAMET WASPADI - NIK: 3276100406750002
✅ Added: MUHAMAD RIVA GUSTAVIA - NIK: 3214010508060005
✅ Added: YUDI PERMADI - NIK: 3214081112900006
✅ Added: IKBAL MAULANA - NIK: 3214062909030002
✅ Added: DEVI RAHMADIAN YUSUP - NIK: 3214080808880004
✅ Added: USNI - NIK: 3214120504820005
✅ Added: ALDI JAENUL HAKIM - NIK: 3215161709970002
✅ Added: WAWAN - NIK: 3214082608860001
✅ Added: CEP AYI - NIK: 3214080408840004
✅ Added: SUPARMAN - NIK: 3215140505030010
✅ Added: ASEP HERYANTO - NIK: 3214020109940001
✅ Added: HOTLES NAINGGOLAN - NIK: 3216062407780010
✅ Added: BAGUS ADIYATMA - NIK: 3329100710940001
✅ Added: FADILAH - NIK: 3216091206900010
✅ Added: YOGI MAHENDRA SITOMPUL - NIK: 1202062308030001
✅ Added: TEGUH SUPRAPTO - NIK: 3301230305800002
✅ Added: NUR ARIFUDIN - NIK: 3301232112990003
✅ Added: GIRAN - NIK: 2102031506800001
✅ Added: IMAN SUMANTRI - NIK: 3216210712730003
✅ Added: NOPITA CANDRA DEWI - NIK: 3216064611970020
✅ Added: SUPADI - NIK: 3301121505790001
✅ Added: ADE DANA - NIK: 3217062403680010
✅ Added: IMAM FAUZI - NIK: 3302030206910002
[INFO] Loaded 25 valid personnel records
[PROC] Starting IKH automation with parameters:
   📅 Date: 2025-08-14
   🔄 Shift: 1
   👥 Personnel count: 25
   🖥️ Browser mode: Headless (Background)
🚀 Starting automation...
🗓️ Attempting to set date: 14/08/2025
📅 Target: Day=14, Month=8, Year=2025
📅 Clicking calendar icon...
🔍 === CALENDAR DEBUGGING MODE ===
📸 Calendar screenshot saved: calendar_debug.png
📋 Calendar Analysis Results:
📦 Calendar containers found: 5
   - DIV id='' class='bootstrap-datetimepicker-widget dropdown-menu uset...'
   - DIV id='' class='datepicker...'
   - DIV id='' class='datepicker-days...'
   - TH id='' class='picker-switch...'
   - SPAN id='ahmgawpm002_tanggal_pekerjaan_request_kontraktor_span' class='glyphicon glyphicon-calendar...'
🧭 Navigation buttons found: 0
📅 Date cells found: 42
   - TD '27' class='day old disabled weekend...'
   - TD '28' class='day old disabled...'
   - TD '29' class='day old disabled...'
   - TD '30' class='day old disabled...'
   - TD '31' class='day old disabled...'
   - TD '1' class='day disabled...'
   - TD '2' class='day disabled weekend...'
   - TD '3' class='day disabled weekend...'
   - TD '4' class='day disabled...'
   - TD '5' class='day disabled...'
🏷️ Headers found: 3
   - DIV 'Maintain Izin Kerja Proyek' class='menu-title...'
   - DIV 'Maintain Izin Kerja Harian' class='menu-title...'
   - DIV 'Maintain Izin Kerja Khusus' class='menu-title...'
🔍 === END CALENDAR DEBUGGING ===
🔍 Analyzing calendar debug results...
📝 Header text: 'Maintain Izin Kerja Proyek'
📝 Header text: 'Maintain Izin Kerja Harian'
📝 Header text: 'Maintain Izin Kerja Khusus'
⚠️ No month/year found in headers, checking for numeric patterns...
⚠️ Using fallback: Month=8, Year=2025
🗓️ Detected calendar: Month=8, Year=2025
🎯 Looking for day 14 in calendar...
🔍 Found 1 elements for selector: td.day:not(.disabled):has-text('14')
✅ Clicked day 14 using: td.day:not(.disabled):has-text('14') (element 0)
📝 Calendar result: '14-Aug-2025' vs expected '14/08/2025'
✅ Date set via calendar successfully: 14-Aug-2025
✅ Date setting confirmed successful
🔍 Current date value in field: '14-Aug-2025'
🎯 Expected date value: '14/08/2025'
❌ Date verification failed!
🚨 CRITICAL: Date verification failed! Automation may fail.
🔍 FINAL DEBUG - Field contains: '14-Aug-2025'
🔄 Preparing to set shift to: 1
✅ Shift field is available
🔄 Setting shift to: 1
🎯 Method 1: Standard select_option...
✅ Method 1 successful: 1
✅ Shift setting confirmed successful
🔍 Current shift value: '1'
🎯 Expected shift value: '1'
✅ Shift verification successful!
👥 Processing 25 personnel records...
🔄 Processing 1/25: DANI IBRAHIM (NIK: 3209252101970001)
🔄 Processing 2/25: ASEP PRIYATMAN (NIK: 3214012511700001)
🔄 Processing 3/25: SLAMET WASPADI (NIK: 3276100406750002)
🔄 Processing 4/25: MUHAMAD RIVA GUSTAVIA (NIK: 3214010508060005)
🔄 Processing 5/25: YUDI PERMADI (NIK: 3214081112900006)
⏳ Progress: 20% (5/25)
🔄 Processing 6/25: IKBAL MAULANA (NIK: 3214062909030002)
🔄 Processing 7/25: DEVI RAHMADIAN YUSUP (NIK: 3214080808880004)
🔄 Processing 8/25: USNI (NIK: 3214120504820005)
🔄 Processing 9/25: ALDI JAENUL HAKIM (NIK: 3215161709970002)
🔄 Processing 10/25: WAWAN (NIK: 3214082608860001)
⏳ Progress: 40% (10/25)
🔄 Processing 11/25: CEP AYI (NIK: 3214080408840004)
🔄 Processing 12/25: SUPARMAN (NIK: 3215140505030010)
🔄 Processing 13/25: ASEP HERYANTO (NIK: 3214020109940001)
🔄 Processing 14/25: HOTLES NAINGGOLAN (NIK: 3216062407780010)
🔄 Processing 15/25: BAGUS ADIYATMA (NIK: 3329100710940001)
⏳ Progress: 60% (15/25)
🔄 Processing 16/25: FADILAH (NIK: 3216091206900010)
🔄 Processing 17/25: YOGI MAHENDRA SITOMPUL (NIK: 1202062308030001)
🔄 Processing 18/25: TEGUH SUPRAPTO (NIK: 3301230305800002)
🔄 Processing 19/25: NUR ARIFUDIN (NIK: 3301232112990003)
🔄 Processing 20/25: GIRAN (NIK: 2102031506800001)
⏳ Progress: 80% (20/25)
🔄 Processing 21/25: IMAN SUMANTRI (NIK: 3216210712730003)
🔄 Processing 22/25: NOPITA CANDRA DEWI (NIK: 3216064611970020)
🔄 Processing 23/25: SUPADI (NIK: 3301121505790001)
🔄 Processing 24/25: ADE DANA (NIK: 3217062403680010)
🔄 Processing 25/25: IMAM FAUZI (NIK: 3302030206910002)
⏳ Progress: 100% (25/25)
✅ Automation completed successfully!

🎉 IKH COMPLETED SUCCESSFULLY!
==================================================
✅ Process finished with exit code: 0
⏰ Completion time: 2025-08-14 14:44:22
==================================================
